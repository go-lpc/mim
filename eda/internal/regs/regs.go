// Copyright 2020 The go-lpc Authors. All rights reserved.
// Use of this source code is governed by a BSD-style
// license that can be found in the LICENSE file.

// Package regs holds constants for the EDA registers.
package regs

const (
	NB_HR           = 8
	NB_BITS_CFG_HR  = 872
	NB_BYTES_CFG_HR = 109

	ALT_LWFPGASLVS_OFST = 0xff200000

	// settings for the lightweight HPS to FPGA bridge
	LW_H2F_BASE = ALT_LWFPGASLVS_OFST
	LW_H2F_SPAN = 0x00100000 //enough
	LW_H2F_MASK = LW_H2F_SPAN - 1

	// setting for the HPS to FPGA AXI Bridge
	H2F_BASE = 0xC0000000
	H2F_SPAN = 0x00100000 //enough
	H2F_MASK = H2F_SPAN - 1

	// slave addresses (prefixed by the bridge used)
	// see ../FPGA_SoC/soc_system/soc_system.html
	H2F_FIFO_DAQ_RFM0 = 0x00000098
	H2F_FIFO_DAQ_RFM1 = 0x00000090
	H2F_FIFO_DAQ_RFM2 = 0x00000088
	H2F_FIFO_DAQ_RFM3 = 0x00000080

	H2F_FIFO_DAQ_CSR_RFM0 = 0x00000040
	H2F_FIFO_DAQ_CSR_RFM1 = 0x00000060
	H2F_FIFO_DAQ_CSR_RFM2 = 0x00000020
	H2F_FIFO_DAQ_CSR_RFM3 = 0x00000000

	LW_H2F_LED_PIO    = 0x00010040
	LW_H2F_BUTTON_PIO = 0x000100C0

	LW_H2F_RAM_SC_RFM0 = 0x00011000
	LW_H2F_RAM_SC_RFM1 = 0x00010C00
	LW_H2F_RAM_SC_RFM2 = 0x00010800
	LW_H2F_RAM_SC_RFM3 = 0x00010400

	LW_H2F_PIO_SC_CHECK_RFM0 = 0x00010290
	LW_H2F_PIO_SC_CHECK_RFM1 = 0x00010210
	LW_H2F_PIO_SC_CHECK_RFM2 = 0x000100F0
	LW_H2F_PIO_SC_CHECK_RFM3 = 0x00010200

	LW_H2F_PIO_STATE_IN = 0x000100A0
	LW_H2F_PIO_CTRL_OUT = 0x00010060
	LW_H2F_PIO_PULSER   = 0x00010020

	LW_H2F_PIO_CNT_HIT0_RFM0 = 0x00010280
	LW_H2F_PIO_CNT_HIT0_RFM1 = 0x00010260
	LW_H2F_PIO_CNT_HIT0_RFM2 = 0x000100D0
	LW_H2F_PIO_CNT_HIT0_RFM3 = 0x00010050

	LW_H2F_PIO_CNT_HIT1_RFM0 = 0x00010270
	LW_H2F_PIO_CNT_HIT1_RFM1 = 0x000100E0
	LW_H2F_PIO_CNT_HIT1_RFM2 = 0x00010090
	LW_H2F_PIO_CNT_HIT1_RFM3 = 0x00010010

	LW_H2F_PIO_CNT_TRIG  = 0x00010250
	LW_H2F_PIO_CNT48_MSB = 0x00010240
	LW_H2F_PIO_CNT48_LSB = 0x00010230
	LW_H2F_PIO_CNT24     = 0x00010220

	// masks for PIO_STATE_IN
	O_HR_TRANSMITON_0 = 0x00000001
	O_CHIPSAT_0       = 0x00000002
	O_HR_END_RO_0     = 0x00000004
	O_SC_DONE_0       = 0x00000008
	O_FIFO_IN_VALID_0 = 0x00000010
	O_ALERT_0         = 0x00000020

	O_HR_TRANSMITON_1 = 0x00000040
	O_CHIPSAT_1       = 0x00000080
	O_HR_END_RO_1     = 0x00000100
	O_SC_DONE_1       = 0x00000200
	O_FIFO_IN_VALID_1 = 0x00000400
	O_ALERT_1         = 0x00000800

	O_HR_TRANSMITON_2 = 0x00001000
	O_CHIPSAT_2       = 0x00002000
	O_HR_END_RO_2     = 0x00004000
	O_SC_DONE_2       = 0x00008000
	O_FIFO_IN_VALID_2 = 0x00010000
	O_ALERT_2         = 0x00020000

	O_HR_TRANSMITON_3 = 0x00040000
	O_CHIPSAT_3       = 0x00080000
	O_HR_END_RO_3     = 0x00100000
	O_SC_DONE_3       = 0x00200000
	O_FIFO_IN_VALID_3 = 0x00400000
	O_ALERT_3         = 0x00800000

	O_PLL_LCK = 0x01000000

	SHIFT_SYNCHRO_STATE = 28

	// mask for sDCC command monitoring (via PIO_CNT24)
	SHIFT_CMD_CODE_NOW = 24
	SHIFT_CMD_CODE_MEM = 28

	// masks for PIO_CTRL_OUT
	O_RESET           = 0x00000001
	O_ON_OFF_RFM0     = 0x00000002
	O_ON_OFF_RFM1     = 0x00000004
	O_ON_OFF_RFM2     = 0x00000008
	O_ON_OFF_RFM3     = 0x00000010
	O_ENA_RFM0        = 0x00000020
	O_ENA_RFM1        = 0x00000040
	O_ENA_RFM2        = 0x00000080
	O_ENA_RFM3        = 0x00000100
	O_RESET_HR        = 0x00000200
	O_SELECT_SC_RR    = 0x00000400
	O_RESET_SC        = 0x00000800
	O_START_SC_0      = 0x00001000
	O_START_SC_1      = 0x00002000
	O_START_SC_2      = 0x00004000
	O_START_SC_3      = 0x00008000
	O_SEL_CMD_SOURCE  = 0x00010000
	SHIFT_CMD_CODE    = 17
	O_RST_SCALERS     = 0x00200000
	O_ENA_SCALERS     = 0x00400000
	O_SEL_TRIG_THRESH = 0x00800000
	O_ENA_TRIG        = 0x01000000
	O_CTEST           = 0x02000000
	O_HPS_BUSY        = 0x04000000
	O_ENA_DCC_BUSY    = 0x08000000
	O_ENA_DCC_RAMFULL = 0x10000000
	O_BBL_RST         = 0x20000000

	EDA_DIF_ID_OFFS = 0x00

	// synchro states
	S_IDLE        = 0
	S_RST_CNT48   = 1
	S_RST_CNT24   = 2
	S_ACQ         = 3
	S_RAMFULL     = 4
	S_START_RO    = 5
	S_WAIT_END_RO = 6
	S_FIFO_READY  = 7
	S_STOP_RUN    = 8

	// commands
	CMD_RESET_BCID  = 1
	CMD_START_ACQ   = 2
	CMD_RAMFULL_EXT = 3
	CMD_STOP_ACQ    = 5
	CMD_DIGITAL_RO  = 6
	CMD_IDLE        = 0xE

	ALTERA_AVALON_FIFO_OTHER_INFO_REG = 1
	ALTERA_AVALON_FIFO_DATA_REG       = 0

	ALTERA_AVALON_FIFO_LEVEL_REG       = 0
	ALTERA_AVALON_FIFO_STATUS_REG      = 1
	ALTERA_AVALON_FIFO_EVENT_REG       = 2
	ALTERA_AVALON_FIFO_IENABLE_REG     = 3
	ALTERA_AVALON_FIFO_ALMOSTFULL_REG  = 4
	ALTERA_AVALON_FIFO_ALMOSTEMPTY_REG = 5

	ALTERA_AVALON_FIFO_EVENT_ALL = 0x3F

	ALTERA_AVALON_FIFO_STATUS_F_MSK   = 0x01
	ALTERA_AVALON_FIFO_STATUS_E_MSK   = 0x02
	ALTERA_AVALON_FIFO_STATUS_AF_MSK  = 0x04
	ALTERA_AVALON_FIFO_STATUS_AE_MSK  = 0x08
	ALTERA_AVALON_FIFO_STATUS_OVF_MSK = 0x10
	ALTERA_AVALON_FIFO_STATUS_UDF_MSK = 0x20
	ALTERA_AVALON_FIFO_STATUS_ALL     = 0x3F

	ALTERA_AVALON_FIFO_IENABLE_F_MSK   = 0x01
	ALTERA_AVALON_FIFO_IENABLE_E_MSK   = 0x02
	ALTERA_AVALON_FIFO_IENABLE_AF_MSK  = 0x04
	ALTERA_AVALON_FIFO_IENABLE_AE_MSK  = 0x08
	ALTERA_AVALON_FIFO_IENABLE_OVF_MSK = 0x10
	ALTERA_AVALON_FIFO_IENABLE_UDF_MSK = 0x20
	ALTERA_AVALON_FIFO_IENABLE_ALL     = 0x3F
)
